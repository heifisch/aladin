<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="create_3" script:language="StarBasic">&apos; Erstellt von Heiko Fischer
&apos; heiko.fischer@aladin-gmbh.de  -  www.aladin-gmbh.de
&apos; Veröffentlicht unter GPL

REM  *****  BASIC  *****
option explicit

Sub SQL_create_Leerzeilen()
	sSQL=&quot;create table Leerzeilen(AnzahlID int(2)not null default 0,Inhalt varchar(255),primary key(AnzahlID))&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(0,&apos;&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(1,&apos;\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(2,&apos;\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(3,&apos;\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(4,&apos;\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(5,&apos;\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(6,&apos;\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(7,&apos;\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(8,&apos;\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(9,&apos;\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(10,&apos;\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(11,&apos;\n\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(12,&apos;\n\n\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(13,&apos;\n\n\n\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(14,&apos;\n\n\n\n\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Leerzeilen(AnzahlID,Inhalt) values(15,&apos;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

Sub SQL_create_Monate()
	sSQL=&quot;create table Monate(MonatID char(2)not null default &apos;&apos;,Monat varchar(20),primary key(MonatID))&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;1&apos;,&apos;Januar&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;2&apos;,&apos;Februar&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;3&apos;,&apos;März&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;4&apos;,&apos;April&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;5&apos;,&apos;Mai&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;6&apos;,&apos;Juni&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;7&apos;,&apos;Juli&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;8&apos;,&apos;August&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;9&apos;,&apos;September&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;10&apos;,&apos;Oktober&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;11&apos;,&apos;November&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL=&quot;insert into Monate(MonatID,Monat) values(&apos;12&apos;,&apos;Dezember&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

Sub SQL_create_Pos_Typ()
	sSQL=&quot;create table Pos_Typ (Pos_TypID int(1)not null auto_increment,Pos_Typ varchar(255) not null default &apos;&apos;,primary key(Pos_TypID)) ENGINE = InnoDB&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL= &quot;insert into Pos_Typ(Pos_TypID)values(1)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Typ(Pos_TypID,Pos_Typ)values(2,&apos;*** Alternativposition ***&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Typ(Pos_TypID,Pos_Typ)values(3,&apos;*** Eventualposition ***&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Typ(Pos_TypID,Pos_Typ)values(4,&apos;*** Abschlagszahlung ***&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

Sub SQL_create_Einheit()
	sSQL=&quot;create table Einheit (EinheitID int(2)not null auto_increment,Einheit varchar(20),primary key(EinheitID))&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Stück&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;m&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;pauschal&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;VPE&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;100 St.&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Paar&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Sack&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Stunde&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;100 m&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Minute&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Einheit(Einheit)values(&apos;Tag&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

Sub SQL_create_Status()
	sSQL=&quot;create table Status (StatusID int(2)not null auto_increment,Status varchar(20),primary key(StatusID))&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL= &quot;insert into Status(Status)values(&apos;skontofähig&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;berechnet&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;fällig&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;erinnert&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;überfällig&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;gemahnt&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;überüberfällig&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;Mahnverfahren&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;bezahlt&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;Einzug&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Status(Status)values(&apos;nicht eintreibbar&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

Sub SQL_drop_Arbeitstabellen()
Dim iCount as Integer
	if iUserAnzahl &lt; 1 then
		SetUserAnzahl()
	End if
	For iCount = 1 to iUserAnzahl
		For iCountTable = 1 to 16
			select case iCountTable
			case 1
				sArbeitstabelle = &quot;Angebote2_TEMP&quot;&amp; (iCount*2)-1
			case 2
				sArbeitstabelle = &quot;Angebote2_TEMP&quot;&amp; (iCount*2)
			case 3
				sArbeitstabelle = &quot;Auftragsbestaetigungen2_TEMP&quot;&amp; (iCount*2)-1
			case 4
				sArbeitstabelle = &quot;Auftragsbestaetigungen2_TEMP&quot;&amp; (iCount*2)
			case 5
				sArbeitstabelle = &quot;Lieferscheine2_TEMP&quot;&amp; (iCount*2)-1
			case 6
				sArbeitstabelle = &quot;Lieferscheine2_TEMP&quot;&amp; (iCount*2)
			case 7
				sArbeitstabelle = &quot;Aufmasze2_TEMP&quot;&amp; (iCount*2)-1
			case 8
				sArbeitstabelle = &quot;Aufmasze2_TEMP&quot;&amp; (iCount*2)
			case 9
				sArbeitstabelle = &quot;Rechnungen2_TEMP&quot;&amp; (iCount*2)-1
			case 10
				sArbeitstabelle = &quot;Rechnungen2_TEMP&quot;&amp; (iCount*2)
			case 11
				sArbeitstabelle = &quot;Gutschriften2_TEMP&quot;&amp; (iCount*2)-1
			case 12
				sArbeitstabelle = &quot;Gutschriften2_TEMP&quot;&amp; (iCount*2)
			case 13
				sArbeitstabelle = &quot;Preisanfragen2_TEMP&quot;&amp; (iCount*2)-1
			case 14
				sArbeitstabelle = &quot;Preisanfragen2_TEMP&quot;&amp; (iCount*2)
			case 15
				sArbeitstabelle = &quot;Bestellungen2_TEMP&quot;&amp; (iCount*2)-1
			case 16
				sArbeitstabelle = &quot;Bestellungen2_TEMP&quot;&amp; (iCount*2)
			End select
			sSQL=&quot;drop table if exists &quot;&amp; sArbeitstabelle 
			SQL_execute_mysql(sSQL)
		Next iCountTable
	Next iCount
End Sub

Sub SQL_create_Arbeitstabellen()
Dim iCount as Integer
	if iUserAnzahl &lt; 1 then
		SetUserAnzahl()
	End if
	For iCount = 1 to iUserAnzahl
		For iCountTable = 1 to 16
			select case iCountTable
			case 1
				sArbeitstabelle = &quot;Angebote2_TEMP&quot;&amp; (iCount*2)-1
			case 2
				sArbeitstabelle = &quot;Angebote2_TEMP&quot;&amp; (iCount*2)
			case 3
				sArbeitstabelle = &quot;Auftragsbestaetigungen2_TEMP&quot;&amp; (iCount*2)-1
			case 4
				sArbeitstabelle = &quot;Auftragsbestaetigungen2_TEMP&quot;&amp; (iCount*2)
			case 5
				sArbeitstabelle = &quot;Lieferscheine2_TEMP&quot;&amp; (iCount*2)-1
			case 6
				sArbeitstabelle = &quot;Lieferscheine2_TEMP&quot;&amp; (iCount*2)
			case 7
				sArbeitstabelle = &quot;Aufmasze2_TEMP&quot;&amp; (iCount*2)-1
			case 8
				sArbeitstabelle = &quot;Aufmasze2_TEMP&quot;&amp; (iCount*2)
			case 9
				sArbeitstabelle = &quot;Rechnungen2_TEMP&quot;&amp; (iCount*2)-1
			case 10
				sArbeitstabelle = &quot;Rechnungen2_TEMP&quot;&amp; (iCount*2)
			case 11
				sArbeitstabelle = &quot;Gutschriften2_TEMP&quot;&amp; (iCount*2)-1
			case 12
				sArbeitstabelle = &quot;Gutschriften2_TEMP&quot;&amp; (iCount*2)
			case 13
				sArbeitstabelle = &quot;Preisanfragen2_TEMP&quot;&amp; (iCount*2)-1
			case 14
				sArbeitstabelle = &quot;Preisanfragen2_TEMP&quot;&amp; (iCount*2)
			case 15
				sArbeitstabelle = &quot;Bestellungen2_TEMP&quot;&amp; (iCount*2)-1
			case 16
				sArbeitstabelle = &quot;Bestellungen2_TEMP&quot;&amp; (iCount*2)
			End select
			sSQL=&quot;create table &quot;&amp; sArbeitstabelle &amp;&quot; (Pos int(6)not null auto_increment,LV_Pos varchar(10),&quot;&amp;_
				&quot;Pos_TypID int(1) not null default 1,&quot;&amp;_
				&quot;PositionsID int(11),DocumentID int(10)not null default 0,LeistungsID varchar(25) not null default &apos;&apos;,Bestellnummer varchar(25),&quot;&amp;_
				&quot;Leistungsbezeichnung varchar(255),Leistungsbeschreibung varchar(10000) not null,&quot;&amp;_
				&quot;Einheit varchar(10),Menge decimal(9,2),Einkaufspreis decimal(11,2),Bauzeit decimal(9,2),&quot;&amp;_
				&quot;Minutenverrechnungssatz decimal(7,4),Materialaufschlagsatz decimal(5,2),Lieferung decimal(11,2),&quot;&amp;_
				&quot;Leistung decimal(11,2),EP decimal(11,2),GP decimal(11,2),GZ decimal(11,2) not null default 0,primary key(Pos)) ENGINE = InnoDB&quot;
			SQL_execute_mysql(sSQL)
		Next iCountTable
	Next iCount
End Sub

Sub SQL_drop_Table(sTable as String)
	sSQL=&quot;drop table if exists &quot;&amp; sTable 
	SQL_execute_mysql(sSQL)
End Sub

Sub SQL_create_Serienbrief_Kontakte()
	sTabelname=&quot;Serienbrief_Kontakte&quot;
	sSQL=&quot;create table &quot;&amp; sTabelname &amp;_
		&quot;(SerBrieKontaktID int(10)not null auto_increment,ClientID int(4)not null,KontaktTyp varchar(20) not null default &apos;&apos;,KontaktID int(10)not null,&quot;&amp;_
		&quot;Anrede varchar(50) not null default &apos;&apos;,Name1 varchar(100)not null default &apos;&apos;,&quot;&amp;_
		&quot;Titel varchar(50) not null default &apos;&apos;,Vorname varchar(50)not null default &apos;&apos;,&quot;&amp;_
		&quot;Name2 varchar(100)not null default &apos;&apos;,Name3 varchar(100)not null default &apos;&apos;,Name4 varchar(100)not null default &apos;&apos;,Land varchar(20),&quot;&amp;_
		&quot;PLZ varchar(6),Ort varchar(50) not null default &apos;&apos;,Strasse varchar(50) not null default &apos;&apos;,Hausnummer varchar(10) not null default &apos;&apos;,Mindestangaben varchar(255),&quot;&amp;_
		&quot;Telefon varchar(30),Funktelefon varchar(30),Fax varchar(30),EMail varchar(50),Url varchar(50),&quot;&amp;_
		&quot;ReferenzID varchar(20),Bemerkungen varchar(2000) not null,Serienbrief int(1) not null default &apos;0&apos;,&quot;&amp;_
		&quot;primary key(SerBrieKontaktID))&quot;
	SQL_execute_mysql(sSQL)
End Sub

Sub SQL_create_Serienbrief_Listen()
	sTabelname=&quot;Serienbrief_Listen&quot;
	sSQL=&quot;create table &quot;&amp; sTabelname &amp;_
		&quot;(ListenID int(10)not null auto_increment,Listenname varchar(255)not null default &apos;&apos;,KontaktTyp varchar(20) not null default &apos;&apos;,ListenMitglieder varchar(2000),&quot;&amp;_
		&quot;primary key(ListenID))&quot;
	SQL_execute_mysql(sSQL)
End Sub

Sub SQL_create_Pos_Format()
	sSQL=&quot;create table Pos_Format (Pos_FormatID int(2)not null auto_increment,Pos_Format varchar(20),primary key(Pos_FormatID))&quot;
	SQL_execute_mysql(sSQL)
	if iDatenAnlegen=1 then
		sSQL= &quot;insert into Pos_Format(Pos_Format)values(&apos;1&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Format(Pos_Format)values(&apos;0.1&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Format(Pos_Format)values(&apos;0.0.1&apos;)&quot;
		SQL_execute_mysql(sSQL)
		sSQL= &quot;insert into Pos_Format(Pos_Format)values(&apos;0.0.0.1&apos;)&quot;
		SQL_execute_mysql(sSQL)
	End If
End Sub

</script:module>